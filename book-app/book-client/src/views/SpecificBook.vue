<script setup>
import { onMounted, ref } from 'vue';
import { useRoute } from 'vue-router';
import { reactive } from 'vue';
import axios from 'axios';

const route = useRoute();
const bookId = route.params.id;
const book = ref(null);
const API_URL = import.meta.env.VITE_API_URL;

// Reactive form object, used to bind user input fields for submitting a book review.
const form = reactive({
  name: '',
  content: '',
  rating: ''
});

const successMessage = ref('');

// fetches book details from the api using book id from the route:
// retrieved data is assigned to the book ref for rendering in component.
const fetchBook = async () => {
  try {
    const response = await axios.get(`${API_URL}/books/${bookId}`);
    console.log('Book data:', response.data)
    book.value = response.data;
  } catch (error) {
    console.error('Error loading book:', error);
  }
};

// submits new book review to the api using data from the reactive form
// when submit is successful it refetches to update the book details and reviews. Clears the form fields and shows temporary success message
const submitReview = async () => {
  try {
    const response = await axios.post(
      `${API_URL}/reviews/books/${bookId}/reviews`,
      {
        name: form.name,
        content: form.content,
        rating: parseInt(form.rating),
        bookId: bookId
      }
    );

    await fetchBook();

    form.name = '';
    form.content = '';
    form.rating = '';

    successMessage.value = 'You submitted a Review!'
    setTimeout(() =>{
      successMessage.value = '';
    },3000);

  } catch (error) {
    console.error('Error submitting review:', error);
    alert(`Failed to submit review: ${error.response?.data?.message || error.message}`);
  }
};
// calls fetch book and ensures the book data is being loaded as soon page is being rendered
onMounted(fetchBook);
</script>

<template>
  <main v-if="book">
    <!-- image at the top -->
    <div class="top-image">
      <img :src="book.image" alt="Book cover" />
    </div>
    <!-- Button to go back -->
    <div class="back-btn-box">
      <router-link class="button-back" to="/">
        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#000000">
          <path d="m313-440 224 224-57 56-320-320 320-320 57 56-224 224h487v80H313Z" />
        </svg>
        <p class="back-text">Back</p>
      </router-link>
    </div>
    <!-- Section that Hold Book Image and all the information -->
    <div class="book-section">
      <div class="book-section-left">
        <img :src="book.image" alt="Book cover" />
      </div>
      <div class="book-section-right">
        <h1>{{ book.title }}</h1>
        <p><span>Author:</span> {{ book.author }}</p>
        <p><span>Published:</span> {{ book.published_year }}</p>
        <ul>
          <p><span>Genres:</span></p>
          <li v-for="(genre, index) in book.genres" :key="index">{{ genre }}</li>
        </ul>
        <p><span>Description:</span> {{ book.description }}</p>
      </div>
      <svg class="owl" width="200" height="200" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M124.648 20C117.217 20 111.25 21.561 106.379 24.0273C98.4602 24.2308 93.2438 27.4341 90.2031 30.6875C87.1062 34.001 86.082 37.4336 86.082 37.4336C85.994 37.7319 85.9767 38.0466 86.0316 38.3528C86.0865 38.6589 86.212 38.948 86.3982 39.1972C86.5844 39.4463 86.8261 39.6486 87.1042 39.788C87.3822 39.9273 87.689 39.9999 88 40H88.3594C87.1814 42.2873 86 45.6031 86 50C86.0001 50.5304 86.2108 51.0391 86.5858 51.4142C86.9609 51.7892 87.4696 51.9999 88 52H90V56C90 59.0033 90.5094 61.6579 91.3984 64.0078C85.1933 65.553 79.647 68.8605 73.9688 74.1797C73.7036 74.2891 73.4652 74.4543 73.2695 74.6641C59.258 89.698 48.0104 110.539 40.1992 130.094C32.3881 149.649 28 167.753 28 178C28.0001 178.53 28.2108 179.039 28.5858 179.414C28.9609 179.789 29.4696 180 30 180C40.4102 180 59.0769 173.625 80.2812 162.754L83.6992 166.723C78.2704 170.878 78 178 78 178C78.0001 178.53 78.2108 179.039 78.5858 179.414C78.9609 179.789 79.4696 180 80 180H97.6992H114.801H132.801H144.012C144.542 180 145.051 179.789 145.426 179.414C145.801 179.039 146.012 178.53 146.012 178V176.688C146.012 169.986 140.995 164.023 134.113 164.023H132.801H129.719L117.676 152.148C127.398 145.562 141.011 135.221 146.438 123.281C146.502 123.346 146.502 123.345 146.566 123.41C147.065 123.911 147.563 124.413 147.945 124.793C148.136 124.983 148.299 125.142 148.422 125.262C148.483 125.321 148.531 125.37 148.582 125.418C148.608 125.442 148.633 125.464 148.68 125.504C148.703 125.524 148.727 125.545 148.797 125.598C148.832 125.624 148.98 125.719 148.98 125.719L149.227 125.844L150 126C150.375 126 150.744 125.895 151.062 125.696C151.38 125.497 151.636 125.213 151.801 124.875C154.743 118.813 155.707 109.202 155.859 102H158C158.53 102 159.039 101.789 159.414 101.414C159.789 101.039 160 100.53 160 100C160 86.6552 154.889 77.9904 150.359 72.9531C156.148 69.5938 160 63.9891 160 56V52H162C162.53 51.9999 163.039 51.7892 163.414 51.4142C163.789 51.0391 164 50.5304 164 50C164 45.6031 162.819 42.2873 161.641 40H162C162.32 40 162.635 39.9233 162.919 39.7764C163.203 39.6296 163.447 39.4167 163.632 39.1558C163.817 38.8949 163.937 38.5935 163.981 38.2768C164.025 37.9602 163.993 37.6375 163.887 37.3359C163.887 37.3359 162.683 33.9392 159.43 30.6562C156.237 27.4338 150.893 24.2502 142.973 24.0469C138.096 21.5782 132.089 20 124.648 20ZM124.648 24C130.164 24 134.709 24.9052 138.504 26.375C135.655 26.944 132.722 28.12 130.211 29.8555C130.098 29.9281 130.001 30.0226 129.926 30.1334C129.85 30.2443 129.798 30.3691 129.772 30.5006C129.746 30.6321 129.746 30.7675 129.773 30.8988C129.8 31.03 129.854 31.1545 129.93 31.2648C130.006 31.3751 130.104 31.4689 130.217 31.5407C130.33 31.6125 130.457 31.6608 130.589 31.6827C130.721 31.7047 130.857 31.6998 130.987 31.6684C131.117 31.637 131.24 31.5798 131.348 31.5C134.609 29.2465 138.834 27.9766 142.207 27.9766C142.223 27.9769 142.238 27.9769 142.254 27.9766C142.341 27.9888 142.428 27.9953 142.516 27.9961C149.659 28.0754 153.939 30.7932 156.59 33.4688C157.521 34.4086 157.992 35.2016 158.523 36H158C157.609 36 157.226 36.1148 156.899 36.3302C156.572 36.5456 156.316 36.8521 156.162 37.2118C156.007 37.5715 155.962 37.9685 156.031 38.3537C156.1 38.7389 156.281 39.0954 156.551 39.3789C156.551 39.3789 159.18 42.338 159.77 48H158C157.47 48.0001 156.961 48.2108 156.586 48.5858C156.211 48.9609 156 49.4696 156 50V55.1172C155.699 56.1089 155.299 57.1121 154.73 58.0664C152.851 61.2209 149.39 63.9336 142.203 63.9336C137.16 63.9336 133.318 61.6522 130.562 59.1172C130.695 58.8848 130.845 58.654 130.965 58.4219C131.564 57.2604 132.016 56.1353 132.016 55.0039C132.016 51.1475 128.868 47.9961 125.012 47.9961C121.155 47.9961 118.008 51.1475 118.008 55.0039C118.008 56.1341 118.458 57.2605 119.055 58.4219C119.1 58.5095 119.16 58.5959 119.207 58.6836C116.429 61.3847 112.432 63.9336 107.102 63.9336C106.969 63.9317 106.837 63.9562 106.715 64.0056C106.592 64.055 106.48 64.1284 106.385 64.2214C106.291 64.3145 106.216 64.4254 106.165 64.5476C106.114 64.6699 106.087 64.8011 106.087 64.9336C106.087 65.0661 106.114 65.1973 106.165 65.3196C106.216 65.4418 106.291 65.5527 106.385 65.6458C106.48 65.7388 106.592 65.8122 106.715 65.8616C106.837 65.911 106.969 65.9355 107.102 65.9336C112.852 65.9336 117.231 63.2642 120.25 60.4414C120.558 60.914 120.872 61.3842 121.191 61.8281C122.726 63.9641 124.254 65.668 124.254 65.668C124.348 65.7724 124.462 65.856 124.591 65.9132C124.719 65.9703 124.858 65.9999 124.998 65.9999C125.138 65.9999 125.277 65.9703 125.405 65.9132C125.534 65.856 125.648 65.7724 125.742 65.668C125.742 65.668 127.28 63.9641 128.82 61.8281C129.048 61.512 129.268 61.1718 129.492 60.8398C132.492 63.5096 136.726 65.9336 142.203 65.9336C148.927 65.9336 153.085 63.5314 155.496 60.4727C154.393 65.1599 151.449 68.1163 147.008 70.2461C141.291 72.9875 133.03 73.9844 124.016 73.9844C115.001 73.9844 107.259 72.9819 102.066 70.2773C99.4478 68.9135 97.4227 67.2012 96.0547 64.8789V64.875C95.992 64.6754 95.8984 64.487 95.7773 64.3164C95.3173 63.4388 94.9373 62.4834 94.6562 61.4258C96.5249 63.3709 99.1956 64.9509 102.949 65.5977C103.081 65.6271 103.218 65.6294 103.351 65.6044C103.484 65.5795 103.611 65.5277 103.723 65.4523C103.836 65.377 103.932 65.2796 104.006 65.166C104.079 65.0524 104.129 64.925 104.152 64.7916C104.175 64.6582 104.171 64.5215 104.14 64.3898C104.108 64.258 104.05 64.1341 103.97 64.0254C103.889 63.9166 103.787 63.8254 103.67 63.7573C103.553 63.6891 103.423 63.6455 103.289 63.6289C98.0468 62.7256 95.4798 60.0475 94.0664 57.125C94.062 57.116 94.059 57.1067 94.0547 57.0977C94.0395 56.7283 94 56.3874 94 56V50C93.9999 49.4696 93.7892 48.9609 93.4142 48.5858C93.0391 48.2108 92.5304 48.0001 92 48H90.2305C90.8201 42.338 93.4492 39.3789 93.4492 39.3789C93.719 39.0954 93.8996 38.7389 93.9688 38.3537C94.038 37.9685 93.9926 37.5715 93.8383 37.2118C93.6841 36.8521 93.4277 36.5456 93.1009 36.3302C92.7741 36.1148 92.3914 36 92 36H91.293C91.7797 35.1931 92.2287 34.3809 93.125 33.4219C95.6051 30.7683 99.6922 28.0607 106.832 27.9805C106.884 27.9799 106.936 27.9773 106.988 27.9727C107.026 27.9761 107.064 27.9774 107.102 27.9766C110.242 27.9766 114.372 29.0859 117.727 31.0664C121.081 33.0469 123.603 35.8342 124.008 39.1211C124.037 39.3605 124.152 39.5812 124.331 39.7426C124.51 39.9041 124.742 39.9953 124.983 39.9996C125.224 40.0039 125.458 39.9209 125.643 39.7659C125.828 39.611 125.951 39.3944 125.988 39.1562C126.284 37.2681 127.157 35.5727 128.434 34.0859C128.519 33.9862 128.584 33.8705 128.625 33.7455C128.666 33.6206 128.682 33.4888 128.672 33.3576C128.662 33.2265 128.627 33.0986 128.567 32.9813C128.508 32.8639 128.426 32.7594 128.326 32.6738C128.226 32.5881 128.111 32.5229 127.986 32.482C127.861 32.441 127.729 32.4251 127.598 32.435C127.467 32.445 127.339 32.4807 127.222 32.5401C127.104 32.5995 127 32.6815 126.914 32.7812C126.025 33.8162 125.363 35.0047 124.836 36.2617C123.607 33.4454 121.55 31.0013 118.742 29.3438C116.244 27.8687 113.442 26.8885 110.77 26.3828C114.564 24.9027 119.098 24 124.648 24ZM108.996 39.9961C107.58 39.9961 106.306 40.3229 105.199 40.7695C102.103 42.0259 100.227 44.3711 100.227 44.3711C100.136 44.4825 100.071 44.6121 100.036 44.7509C99.9998 44.8898 99.9943 45.0347 100.02 45.1758C100.02 45.1758 100.403 47.3547 101.789 49.5391C103.175 51.7234 105.714 54.0078 109.719 54.0078C113.109 54.0078 116.252 51.8513 117.816 49.5703C117.897 49.4517 117.952 49.317 117.976 49.1755C118 49.0339 117.994 48.8888 117.957 48.75C117.957 48.75 117.34 46.3747 115.809 44.0977H115.812C114.457 42.0758 112.232 39.9961 108.996 39.9961ZM140.996 39.9961C137.76 39.9961 135.539 42.0758 134.184 44.0977H134.188C132.656 46.3747 132.039 48.75 132.039 48.75C132.002 48.8888 131.996 49.0339 132.02 49.1755C132.044 49.317 132.099 49.4517 132.18 49.5703C133.744 51.8513 136.887 54.0078 140.277 54.0078C144.282 54.0078 146.821 51.7234 148.207 49.5391C149.593 47.3547 149.977 45.1758 149.977 45.1758C150.002 45.0347 149.996 44.8898 149.961 44.7509C149.925 44.6121 149.86 44.4825 149.77 44.3711C149.77 44.3711 147.893 42.0259 144.797 40.7695C143.69 40.3229 142.412 39.9961 140.996 39.9961ZM108.902 42.1875C111.037 42.1875 112.469 43.4471 113.574 44.9492C113.146 46.6687 111.783 47.9883 109.945 47.9883C107.755 47.9883 106.004 46.2367 106.004 44.0469C106.004 43.5835 106.178 43.1495 106.355 42.7109C107.148 42.4301 107.972 42.1875 108.902 42.1875ZM141.125 42.1875C142.055 42.1875 142.879 42.4301 143.672 42.7109C143.849 43.1495 144.023 43.5835 144.023 44.0469C144.022 46.2371 142.269 47.9883 140.082 47.9883C138.243 47.9883 136.88 46.6666 136.453 44.9453C137.558 43.4451 138.992 42.1875 141.125 42.1875ZM104.055 43.6641C104.045 43.7948 104.004 43.9123 104.004 44.0469C104.004 47.317 106.675 49.9883 109.945 49.9883C112.188 49.9883 114.093 48.7102 115.078 46.8672C115.506 47.781 115.714 48.4947 115.793 48.7656C114.516 50.3482 112.02 52.0078 109.719 52.0078C106.448 52.0078 104.631 50.2884 103.477 48.4688C102.483 46.9025 102.28 45.7392 102.191 45.332C102.38 45.1149 103.007 44.3936 104.055 43.6641ZM145.973 43.6875C146.999 44.409 147.618 45.1172 147.805 45.332C147.716 45.7392 147.513 46.9025 146.52 48.4688C145.365 50.2884 143.548 52.0078 140.277 52.0078C137.976 52.0078 135.48 50.3482 134.203 48.7656C134.283 48.4915 134.494 47.7658 134.934 46.8359C135.915 48.6947 137.828 49.9883 140.082 49.9883C143.351 49.9883 146.021 47.3166 146.023 44.0469C146.023 43.9204 145.982 43.8106 145.973 43.6875ZM125.012 49.9961C127.787 49.9961 130.016 52.2283 130.016 55.0039C130.016 55.5305 129.716 56.4798 129.188 57.5039C129.004 57.8591 128.774 58.2323 128.551 58.6016C128.442 58.7154 128.362 58.8532 128.316 59.0039C127.961 59.5654 127.581 60.1254 127.195 60.6602C126.1 62.1785 125.49 62.8421 125.004 63.4023C124.52 62.8425 123.908 62.1791 122.816 60.6602C122.086 59.6432 121.359 58.532 120.832 57.5078C120.306 56.4837 120.008 55.5317 120.008 55.0039C120.008 52.2283 122.236 49.9961 125.012 49.9961ZM93.2969 67.6836C95.0386 70.2783 97.3783 72.3448 100.219 73.8242C106.457 77.0732 114.722 77.9844 124.016 77.9844C125.389 77.9844 126.746 77.9548 128.09 77.9102C130.206 80.273 132.033 82.9015 133.473 85.7617C133.528 85.8845 133.608 85.9949 133.707 86.086C133.807 86.1772 133.923 86.2474 134.05 86.2923C134.178 86.3373 134.312 86.356 134.447 86.3475C134.582 86.339 134.713 86.3034 134.833 86.2428C134.954 86.1821 135.061 86.0978 135.148 85.9948C135.235 85.8919 135.3 85.7723 135.34 85.6435C135.379 85.5146 135.393 85.3791 135.378 85.245C135.364 85.1109 135.323 84.9811 135.258 84.8633C133.983 82.3311 132.428 79.9654 130.645 77.7969C136.481 77.453 141.916 76.5684 146.559 74.7734C150.494 78.8228 155.248 86.1096 155.789 98H154C153.47 98.0001 152.961 98.2108 152.586 98.5858C152.211 98.9609 152 99.4696 152 100C152 105.919 150.858 114.449 148.973 120.156C148.234 119.412 147.422 118.594 147.422 118.594C147.182 118.351 146.883 118.173 146.554 118.078C146.226 117.983 145.878 117.974 145.545 118.052C145.212 118.129 144.905 118.291 144.652 118.521C144.399 118.752 144.21 119.043 144.102 119.367C140.253 130.911 124.101 143.079 113.797 149.945C113.537 150.041 113.301 150.19 113.102 150.383C107.363 154.12 102.133 156.555 102.133 156.555C101.846 156.687 101.595 156.885 101.4 157.132C101.205 157.38 101.071 157.67 101.009 157.98C100.947 158.289 100.96 158.608 101.045 158.912C101.13 159.216 101.286 159.495 101.5 159.727L109.43 168.34C109.617 168.543 109.844 168.705 110.097 168.816C110.349 168.927 110.622 168.984 110.898 168.984H114V176H97.6992H82.3789C82.6819 173.922 83.5032 170.579 87.3828 168.777C87.6638 168.647 87.9107 168.454 88.1043 168.212C88.2978 167.971 88.4327 167.688 88.4982 167.385C88.5637 167.083 88.5581 166.769 88.4818 166.469C88.4055 166.169 88.2607 165.891 88.0586 165.656L82.7109 159.445C82.6873 159.391 82.6612 159.337 82.6328 159.285C93.9936 153.39 105.523 146.875 116.223 138.836C116.393 138.712 116.519 138.538 116.585 138.338C116.65 138.138 116.651 137.923 116.587 137.723C116.523 137.523 116.397 137.348 116.228 137.223C116.059 137.098 115.855 137.03 115.645 137.027C115.418 137.025 115.198 137.099 115.02 137.238C103.815 145.656 91.6335 152.442 79.6523 158.594C79.6458 158.598 79.6393 158.601 79.6328 158.605C59.6333 168.969 41.7315 174.933 32.2148 175.695C32.7539 166.135 36.7605 149.487 43.9141 131.578C51.5546 112.45 62.6049 92.0968 75.9844 77.6484C76.0429 77.6047 76.099 77.5577 76.1523 77.5078C81.9976 71.8941 87.2069 68.9632 93.2969 67.6836ZM136.023 88.3008C135.867 88.3101 135.714 88.3562 135.578 88.4354C135.443 88.5146 135.328 88.6247 135.242 88.7567C135.157 88.8887 135.104 89.039 135.088 89.1953C135.072 89.3515 135.092 89.5095 135.148 89.6562C135.744 91.2959 136.224 92.9925 136.578 94.7344C136.604 94.8631 136.656 94.9855 136.729 95.0944C136.802 95.2034 136.897 95.2968 137.006 95.3693C137.116 95.4419 137.238 95.4921 137.367 95.5172C137.496 95.5423 137.629 95.5418 137.758 95.5156C137.887 95.4895 138.009 95.4382 138.118 95.3648C138.227 95.2913 138.32 95.1971 138.393 95.0876C138.465 94.978 138.516 94.8553 138.541 94.7263C138.566 94.5973 138.565 94.4647 138.539 94.3359C138.165 92.4978 137.66 90.705 137.031 88.9727C136.96 88.7659 136.823 88.5882 136.641 88.4668C136.459 88.3454 136.242 88.2871 136.023 88.3008ZM138.184 97.9102C138.043 97.909 137.904 97.9373 137.776 97.9933C137.647 98.0493 137.532 98.1317 137.437 98.2353C137.342 98.3388 137.271 98.4611 137.226 98.5942C137.182 98.7273 137.166 98.8682 137.18 99.0078C137.258 99.98 137.301 100.963 137.301 101.953C137.301 113.266 132.087 123.339 123.941 129.949C123.838 130.034 123.753 130.138 123.691 130.256C123.628 130.374 123.59 130.503 123.579 130.636C123.567 130.769 123.582 130.902 123.623 131.029C123.664 131.156 123.729 131.274 123.816 131.375C123.837 131.401 123.859 131.426 123.883 131.449C123.888 131.455 123.887 131.454 123.895 131.461L123.898 131.465C124.008 131.571 124.141 131.651 124.286 131.698C124.432 131.745 124.586 131.758 124.737 131.736C124.889 131.714 125.033 131.658 125.159 131.572C125.285 131.485 125.39 131.371 125.465 131.238C133.894 124.261 139.301 113.747 139.301 101.953C139.301 100.908 139.258 99.8714 139.176 98.8477C139.16 98.5948 139.049 98.3573 138.865 98.1833C138.68 98.0093 138.437 97.9117 138.184 97.9102ZM66.0117 104.059C65.8778 104.057 65.7448 104.081 65.6207 104.132C65.4965 104.182 65.3838 104.257 65.2891 104.352C63.2189 106.412 62.5016 109.589 62.1875 112.234C61.8734 114.88 62.0195 117.07 62.0195 117.07C62.0358 117.317 62.1431 117.549 62.3206 117.722C62.4981 117.894 62.7332 117.995 62.9805 118.004C62.9805 118.004 65.2156 118.085 67.8828 117.738C70.5501 117.391 73.7111 116.687 75.6914 114.715C75.8394 114.566 75.9369 114.375 75.97 114.167C76.0032 113.96 75.9704 113.748 75.8762 113.561C75.782 113.373 75.6313 113.22 75.4453 113.123C75.2593 113.026 75.0475 112.99 74.8398 113.02C74.8372 113.02 74.8274 113.022 74.8164 113.023H74.8125C74.7842 113.027 74.741 113.029 74.6797 113.035C74.5571 113.047 74.3726 113.06 74.1445 113.07C73.6883 113.09 73.0526 113.094 72.3555 113.027C70.9612 112.895 69.3685 112.461 68.4219 111.52C67.4857 110.588 67.0677 109.031 66.9492 107.66C66.89 106.975 66.901 106.347 66.9258 105.898C66.9382 105.674 66.9523 105.492 66.9648 105.371C66.971 105.31 66.9769 105.265 66.9805 105.234C66.9823 105.219 66.9832 105.211 66.9844 105.203C67.0049 105.062 66.9953 104.919 66.956 104.782C66.9168 104.646 66.8489 104.519 66.7569 104.411C66.6648 104.303 66.5508 104.215 66.4223 104.154C66.2938 104.094 66.1538 104.061 66.0117 104.059ZM65.1055 108.562C65.3106 110.033 65.7445 111.677 67.0117 112.938C68.2892 114.208 69.9555 114.655 71.4453 114.871C70.2413 115.292 68.8948 115.589 67.625 115.754C65.681 116.007 64.6994 115.957 64.0508 115.949C64.0262 115.314 63.9457 114.374 64.1719 112.469C64.3262 111.169 64.6472 109.807 65.1055 108.562ZM78.0352 116.078C78.0013 116.078 77.9674 116.079 77.9336 116.082C77.699 116.102 77.479 116.205 77.3125 116.371C75.2424 118.432 74.5251 121.608 74.2109 124.254C73.8968 126.9 74.043 129.09 74.043 129.09C74.0593 129.337 74.1665 129.569 74.344 129.741C74.5215 129.914 74.7566 130.014 75.0039 130.023C75.0039 130.023 77.239 130.105 79.9062 129.758C82.5735 129.411 85.7345 128.71 87.7148 126.738C87.8645 126.59 87.9634 126.398 87.9975 126.19C88.0315 125.982 87.999 125.769 87.9046 125.58C87.8102 125.392 87.6587 125.238 87.4717 125.141C87.2847 125.044 87.0717 125.008 86.8633 125.039C86.8609 125.039 86.8581 125.041 86.8477 125.043C86.8438 125.043 86.8398 125.043 86.8359 125.043C86.8074 125.046 86.7606 125.049 86.6992 125.055C86.5764 125.066 86.3923 125.08 86.1641 125.09C85.7076 125.11 85.0721 125.113 84.375 125.047C82.9808 124.914 81.3909 124.48 80.4453 123.539C79.5091 122.608 79.0911 121.05 78.9727 119.68C78.9134 118.994 78.9245 118.367 78.9492 117.918C78.9616 117.694 78.9757 117.512 78.9883 117.391C78.9945 117.33 79.0003 117.284 79.0039 117.254C79.0058 117.239 79.0066 117.231 79.0078 117.223C79.0284 117.082 79.0187 116.939 78.9795 116.802C78.9402 116.665 78.8723 116.539 78.7803 116.43C78.6883 116.322 78.5742 116.235 78.4457 116.174C78.3172 116.113 78.1773 116.081 78.0352 116.078ZM77.1289 120.582C77.3339 122.053 77.7677 123.696 79.0352 124.957C80.314 126.229 81.9811 126.675 83.4727 126.891C82.2663 127.313 80.9215 127.612 79.6484 127.777C77.7045 128.03 76.7228 127.977 76.0742 127.969C76.0496 127.333 75.9692 126.397 76.1953 124.492C76.3497 123.192 76.6707 121.827 77.1289 120.582ZM60.0352 122.078C60.0013 122.078 59.9674 122.079 59.9336 122.082C59.699 122.102 59.479 122.205 59.3125 122.371C57.2424 124.432 56.5251 127.608 56.2109 130.254C55.8968 132.9 56.043 135.09 56.043 135.09C56.0593 135.337 56.1665 135.569 56.344 135.741C56.5215 135.914 56.7566 136.014 57.0039 136.023C57.0039 136.023 59.239 136.105 61.9062 135.758C64.5735 135.411 67.7345 134.71 69.7148 132.738C69.8645 132.59 69.9634 132.398 69.9975 132.19C70.0315 131.982 69.999 131.769 69.9046 131.58C69.8102 131.392 69.6587 131.238 69.4717 131.141C69.2847 131.044 69.0717 131.008 68.8633 131.039C68.8609 131.039 68.8581 131.041 68.8477 131.043C68.8438 131.043 68.8398 131.043 68.8359 131.043C68.8074 131.046 68.7606 131.049 68.6992 131.055C68.5764 131.066 68.3923 131.08 68.1641 131.09C67.7076 131.11 67.0721 131.113 66.375 131.047C64.9808 130.914 63.3909 130.48 62.4453 129.539C61.5091 128.608 61.0911 127.05 60.9727 125.68C60.9134 124.994 60.9245 124.367 60.9492 123.918C60.9616 123.694 60.9757 123.512 60.9883 123.391C60.9945 123.33 61.0003 123.284 61.0039 123.254C61.0058 123.239 61.0066 123.231 61.0078 123.223C61.0284 123.082 61.0187 122.939 60.9795 122.802C60.9402 122.665 60.8723 122.539 60.7803 122.43C60.6883 122.322 60.5742 122.235 60.4457 122.174C60.3172 122.113 60.1773 122.081 60.0352 122.078ZM59.1289 126.582C59.3339 128.053 59.7677 129.696 61.0352 130.957C62.314 132.229 63.9811 132.675 65.4727 132.891C64.2663 133.313 62.9215 133.612 61.6484 133.777C59.7045 134.03 58.7228 133.977 58.0742 133.969C58.0496 133.333 57.9692 132.397 58.1953 130.492C58.3497 129.192 58.6707 127.827 59.1289 126.582ZM90.0352 128.078C90.0013 128.078 89.9674 128.079 89.9336 128.082C89.699 128.102 89.479 128.205 89.3125 128.371C87.2424 130.432 86.5251 133.608 86.2109 136.254C85.8968 138.9 86.043 141.09 86.043 141.09C86.0593 141.337 86.1665 141.569 86.344 141.741C86.5215 141.914 86.7566 142.014 87.0039 142.023C87.0039 142.023 89.239 142.105 91.9062 141.758C94.5735 141.411 97.7345 140.71 99.7148 138.738C99.8645 138.59 99.9634 138.398 99.9975 138.19C100.032 137.982 99.999 137.769 99.9046 137.58C99.8102 137.392 99.6587 137.238 99.4717 137.141C99.2847 137.044 99.0717 137.008 98.8633 137.039C98.8609 137.039 98.8581 137.041 98.8477 137.043C98.8438 137.043 98.8398 137.043 98.8359 137.043C98.8074 137.046 98.7606 137.049 98.6992 137.055C98.5764 137.066 98.3923 137.08 98.1641 137.09C97.7076 137.11 97.0721 137.113 96.375 137.047C94.9808 136.914 93.3909 136.48 92.4453 135.539C91.5091 134.608 91.0911 133.05 90.9727 131.68C90.9134 130.994 90.9245 130.367 90.9492 129.918C90.9616 129.694 90.9757 129.512 90.9883 129.391C90.9945 129.33 91.0003 129.284 91.0039 129.254C91.0058 129.239 91.0066 129.231 91.0078 129.223C91.0284 129.082 91.0187 128.939 90.9795 128.802C90.9402 128.665 90.8723 128.539 90.7803 128.43C90.6883 128.322 90.5742 128.235 90.4457 128.174C90.3172 128.113 90.1773 128.081 90.0352 128.078ZM124.664 129.828L124.754 130.102C124.671 130.385 124.57 130.723 124.57 130.723C124.57 130.723 124.648 129.987 124.664 129.828ZM123.969 131.52C123.99 131.536 124.012 131.552 124.035 131.566C124.02 131.557 123.996 131.543 123.996 131.543C123.996 131.543 123.978 131.527 123.969 131.52ZM121.41 132.426C121.186 132.436 120.971 132.521 120.801 132.668C120.146 133.214 119.482 133.755 118.816 134.289C118.61 134.455 118.478 134.697 118.449 134.961C118.42 135.224 118.498 135.489 118.664 135.695C118.83 135.902 119.072 136.034 119.336 136.063C119.599 136.091 119.864 136.014 120.07 135.848C120.745 135.306 121.417 134.757 122.082 134.203C122.246 134.071 122.364 133.89 122.419 133.687C122.474 133.484 122.464 133.268 122.389 133.071C122.315 132.874 122.18 132.706 122.004 132.59C121.828 132.474 121.621 132.417 121.41 132.426ZM89.1289 132.582C89.3339 134.053 89.7677 135.696 91.0352 136.957C92.314 138.229 93.9811 138.675 95.4727 138.891C94.2663 139.313 92.9215 139.612 91.6484 139.777C89.7045 140.03 88.7228 139.977 88.0742 139.969C88.0496 139.333 87.9692 138.397 88.1953 136.492C88.3497 135.192 88.6707 133.827 89.1289 132.582ZM72.0352 134.078C72.0013 134.078 71.9674 134.079 71.9336 134.082C71.699 134.102 71.479 134.205 71.3125 134.371C69.2424 136.432 68.5251 139.608 68.2109 142.254C67.8968 144.9 68.043 147.09 68.043 147.09C68.0593 147.337 68.1665 147.569 68.344 147.741C68.5215 147.914 68.7566 148.014 69.0039 148.023C69.0039 148.023 71.239 148.105 73.9062 147.758C76.5735 147.411 79.7345 146.71 81.7148 144.738C81.8645 144.59 81.9634 144.398 81.9975 144.19C82.0315 143.982 81.999 143.769 81.9046 143.58C81.8102 143.392 81.6587 143.238 81.4717 143.141C81.2847 143.044 81.0717 143.008 80.8633 143.039C80.8609 143.039 80.8581 143.041 80.8477 143.043C80.8438 143.043 80.8398 143.043 80.8359 143.043C80.8074 143.046 80.7606 143.049 80.6992 143.055C80.5764 143.066 80.3923 143.08 80.1641 143.09C79.7076 143.11 79.0721 143.113 78.375 143.047C76.9808 142.914 75.3909 142.48 74.4453 141.539C73.5091 140.608 73.0911 139.05 72.9727 137.68C72.9134 136.994 72.9245 136.367 72.9492 135.918C72.9616 135.694 72.9757 135.512 72.9883 135.391C72.9945 135.33 73.0003 135.284 73.0039 135.254C73.0058 135.239 73.0066 135.231 73.0078 135.223C73.0284 135.082 73.0187 134.939 72.9795 134.802C72.9402 134.665 72.8723 134.539 72.7803 134.43C72.6883 134.322 72.5742 134.235 72.4457 134.174C72.3172 134.113 72.1773 134.081 72.0352 134.078ZM71.1289 138.582C71.3339 140.053 71.7677 141.696 73.0352 142.957C74.314 144.229 75.9811 144.675 77.4727 144.891C76.2663 145.313 74.9215 145.612 73.6484 145.777C71.7045 146.03 70.7228 145.977 70.0742 145.969C70.0496 145.333 69.9692 144.397 70.1953 142.492C70.3497 141.192 70.6707 139.827 71.1289 138.582ZM52.0352 140.078C52.0013 140.078 51.9674 140.079 51.9336 140.082C51.699 140.102 51.479 140.205 51.3125 140.371C49.2424 142.432 48.5251 145.608 48.2109 148.254C47.8968 150.9 48.043 153.09 48.043 153.09C48.0593 153.337 48.1665 153.569 48.344 153.741C48.5215 153.914 48.7566 154.014 49.0039 154.023C49.0039 154.023 51.239 154.105 53.9062 153.758C56.5735 153.411 59.7345 152.71 61.7148 150.738C61.8645 150.59 61.9634 150.398 61.9975 150.19C62.0315 149.982 61.999 149.769 61.9046 149.58C61.8102 149.392 61.6587 149.238 61.4717 149.141C61.2847 149.044 61.0717 149.008 60.8633 149.039C60.8609 149.039 60.8581 149.041 60.8477 149.043C60.8438 149.043 60.8398 149.043 60.8359 149.043C60.8074 149.046 60.7606 149.049 60.6992 149.055C60.5764 149.066 60.3923 149.08 60.1641 149.09C59.7076 149.11 59.0721 149.113 58.375 149.047C56.9808 148.914 55.3909 148.48 54.4453 147.539C53.5091 146.608 53.0912 145.05 52.9727 143.68C52.9134 142.994 52.9245 142.367 52.9492 141.918C52.9616 141.694 52.9757 141.512 52.9883 141.391C52.9945 141.33 53.0003 141.284 53.0039 141.254C53.0058 141.239 53.0066 141.231 53.0078 141.223C53.0284 141.082 53.0187 140.939 52.9795 140.802C52.9402 140.665 52.8723 140.539 52.7803 140.43C52.6883 140.322 52.5742 140.235 52.4457 140.174C52.3172 140.113 52.1773 140.081 52.0352 140.078ZM51.1289 144.582C51.3339 146.053 51.7677 147.696 53.0352 148.957C54.314 150.23 55.9811 150.675 57.4727 150.891C56.2663 151.313 54.9215 151.612 53.6484 151.777C51.7045 152.03 50.7228 151.977 50.0742 151.969C50.0496 151.333 49.9692 150.397 50.1953 148.492C50.3497 147.192 50.6707 145.827 51.1289 144.582ZM114.25 154.387L127.496 167.449C127.87 167.817 128.374 168.023 128.898 168.023H132V176H128.465C128.091 169.548 122.543 164.984 116.113 164.984H114.801H111.777L106.148 158.867C107.612 158.158 110.2 156.949 114.25 154.387ZM134 168.023H134.113C138.469 168.023 141.575 171.569 141.891 176H134V168.023ZM116 168.984H116.113C120.679 168.984 124.09 171.745 124.434 176H116V168.984Z" fill="white"/>
      </svg>
    </div>
    <!-- Review Section Create review or read others reviews -->
    <div class="review-section">
      <section class="make-review-section">
        <h2>Add a Review</h2>
        <form @submit.prevent="submitReview">
          <div>
            <label for="name">Name:</label>
            <input v-model="form.name" id="name" required />
          </div>
          <div>
            <label for="rating">Rating (1-5):</label>
            <select v-model.number="form.rating" id="rating" required>
              <option disabled value="">Select rating</option>
              <option v-for="n in 5" :key="n" :value="n">{{ n }} Star</option>
            </select>
          </div>
          <div>
            <label for="content">Review:</label>
            <textarea v-model="form.content" id="content" required></textarea>
          </div>
          <p v-if="successMessage" class="success-message">{{ successMessage }}</p>
          <button type="submit">Submit Review</button>
        </form>
      </section>
      <section class="reviews" v-if="book.reviews && book.reviews.length">
        <h2>Reviews:</h2>
        <ul>
          <li v-for="(review, i) in book.reviews" :key="i">
            <div>
              <p>{{ review.name }}</p>
              <img :src="`/assets/images/rating-star-${review.rating}.jpg`" :alt="`Rating: ${review.rating} stars`" />
            </div>
            <p>{{ review.content }}</p>
          </li>
        </ul>
      </section>
      <!-- If no reviews-->
      <section v-else>
        <p>No reviews yet.</p>
      </section>
    </div>
  </main>
  <!-- If No books-->
  <p v-else>Loading book...</p>
</template>


<style lang="scss" scoped>

main {
  padding-right: 40px;
  padding-left: 40px;
  background-color: $color-background;
  height: 100%;
  width: 100%;
  margin-bottom: 5rem;
  .top-image {
    width: 100%;
    height: 400px;
    right: 0;
    img {
      width: 100%;
      /* Ensure the image fits within the container */
      height: 100%;
      /* Ensure the image fits within the container */
      object-fit: cover;
      object-position: center;
      filter: blur(4px);
    }
  }

  .back-btn-box {
    width: 120px;
    height: 40px;
    margin-left: 40px;

    .button-back {
      display: flex;
      align-items: center;
      text-decoration: none;
      font-family: $font-paragraph;
      color: black;
      svg {
        width: 50px;
        height: 40px;
        transform: scale(0.7) translateX(0);
        transition: transform 0.5s ease-in-out;
      }

      .back-text {
        text-align: center;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        height: 100%;
        width: 60px;
      }

      &:hover {
        svg {
          transform: scale(0.7) translateX(-20px);
        }

        .back-text {
          font-weight: bolder;
        }
      }
    }
  }

  .book-section {
    height: auto;
    width: 100%;
    display: flex;
    flex-direction: row;
    justify-content: center;
    position: relative;
    right: 100px;
    gap: 100px;
    margin-bottom: 20px;
    .owl {
      position: absolute;
      right: 0;
      bottom: 25px;
      path {
        fill: $color-red;
      }
    }

    &-left {
      width: 325px;
      height: 500px;
      margin-left: 40px;
      border-radius: 16px;
      box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.692);

      img {
        width: 100%;
        height: 100%;
        border-radius: 16px;
      }
    }

    &-right {
      width: 600px;
      height: auto;
      display: flex;
      flex-direction: column;
      gap: 10px;

      ul {
        display: flex;
        flex-direction: row;
        align-items: center;
        gap: 10px;

        :nth-child(2) {
          background-color: #7CFDC0;
        }

        :nth-child(3) {
          background-color: #7CE1FD;
        }

        :nth-child(4) {
          background-color: #8C979A;
        }

        :nth-child(5) {
          background-color: #EDAF95;
        }

        li {
          font-size: 1.4rem;
          width: auto;
          padding: 5px 5px;
          border-radius: 14px;
          font-family: $font-paragraph;
        }
      }

      h1 {
        font-family: $font-title;
        font-size: $h-medium;
      }

      p {
        font-family: $font-paragraph;
        font-size: 1.3rem;
        white-space: pre-line;
        font-weight: 200;
        line-height: 25px;

        span {
          font-weight: 500;
          font-size: 1.4rem;
        }
      }
    }
  }
  .review-section{
    width: 100%;
    padding-right: 40px;
    padding-left: 40px;
    height: 500px;
    display: flex;
    flex-direction: row;
    background-color: $color-primary;
    justify-content: space-between;
    gap: 50px;
    border-radius: 16px;
    .make-review-section {
      width: 50%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      height: 500px;
      gap: 20px;
      h2{
        font-family: $font-title;
        font-size: $h-small;
        color: white;
        height: 40px;
      }
      form{
        display: flex;
        flex-direction: column;
        gap: 15px;
        height: auto;
        div{
          width: 600px;
          height: auto;
          display: flex;
          flex-direction: column;
          color: white;
          label{
            margin-bottom: 5px;
            font-size: 1.2rem;
          }
          input{
            width: 70%;
            height: 30px;
            border-radius: 10px;
            border: none;
            font-family: $font-paragraph;
            font-size: 0.9rem;
            &:focus{
              outline: none;
              border: 2px solid #4C1C29;
            }
          }
          textarea{
            height: 150px;
            width: 100%;
            padding: 5px 5px;
            border-radius: 10px;
            border: none;
            resize: none;
            font-size: 0.9rem;
            font-family: $font-paragraph;
            &:focus {
              outline: none;
              border: 2px solid #4C1C29;
            }
          }
          select{
            height: 30px;
            width: 70%;
            border-radius: 10px;
            border: none;
            font-family: $font-paragraph;
            font-size: 0.9rem;
              &:focus {
                outline: none;
                border: 2px solid #4C1C29;
              }
            option{
              border-radius: 10px;
              &:focus{
                 border-radius: 10px;
              }
            }
          }

        }
        .success-message{
          font-size: 1rem;
          font-family: $font-paragraph;
          color: rgb(24, 197, 125);
        }
        button{
          width: 130px;
          height: 40px;
          border-radius: 12px;
          border: none;
          cursor: pointer;
          font-size: 1rem;
          font-family: $font-paragraph;
          font-weight: 700;
          outline: none;
          &:hover{
            background: rgb(219, 219, 219);
            border: 1px solid #4C1C29 ;
          }
        }
      }

  }

    .reviews {
      width: 50%;
      height: 450px;
      margin-top: 20px;
      margin-bottom: 20px;
      scroll-behavior: smooth;
      h2{
        color: white;
        font-family: $font-title;
        font-size: $h-small;
        margin-bottom: 20px;
      }
      ul{
        width: 100%;
        display: flex;
        height: 400px;
        flex-direction: column;
        gap: 30px;
        overflow-y: auto;
        scrollbar-width: none; 
        -ms-overflow-style: none; 
        &::-webkit-scrollbar{
         display: none;
        }
        li{
          display: flex;
          flex-direction: row;
          justify-content: space-around;
          gap: 20px;
          height: auto;
          width: 90%;
          border-bottom:2px solid white ;
          div{
              display: flex;
              flex-direction: column;
              gap: 15px;
              width: 100px;
            p{
              color: white;
              font-size: 1.5rem;
              font-family: $font-paragraph;
              text-transform: capitalize;
              

            }
          }
          p{
            color: white;
            font-size: 1rem;
            font-family: $font-paragraph;
            text-transform: capitalize;
            line-height: 20px;
            height: auto;
            width: 500px;
          }
        }
      }
    }

  }

}



@media (max-width: 767px) {
  main{
    padding-right: 20px ;
    padding-left: 20px;
    
    .top-image{
      display: none;
    }
    .book-section{
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
      right: 0;
      gap: 25px;
      height: auto;
      &-left{
        display: flex;
        justify-items: center;
        align-items: center;
        margin-left: 0;
        height: 100%;
        img{
          object-fit: contain;

        }
      }
      &-right{
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        height: auto;
        margin-bottom: 20px;
        h1{
          font-size: $h-medium-mobile ; 
        }
        p{
          font-weight: 400;
        }
        ul{
          height: 70px;
          display: flex;
          flex-wrap: wrap;
          gap: 2px;
          
        }
      }
        .owl{
        display: none;
      }
    }
    .review-section{
      padding-right: 20px;
      padding-left:20px;
      width: 100%;
      flex-direction: column;
      justify-content: end;
      height: auto;
      padding-top: 20px;
      gap: 0;
      .make-review-section{
        width: 100%;
        form{ 
          height: auto;
          div{
            width: 100%;
            input{
              width: 100%;
            }
            select{
              width: 100%;
            }
          }
          button{
          width: 160px;
          height: 40px;
        }
        }

      }
      .reviews{
        width: 100%;
        ul{
          align-items: center;
          
          li{
            flex-direction: column;
            height: auto;
            border-bottom:2px solid white ;
            div{
              flex-direction: column;
              align-items: center;
              gap: 5px;
              width: 100%;
              p{
                text-align: center;
              }
              img{
                width: 200px;
                
              }
            }
            p{
              text-align: start;
            }
          }
        }
      }
    }

  }
}


@media (min-width: 768px) and (max-width: 1024px) {
main{
  padding-right:20px;
  padding-left:20px;
  .book-section{
    flex-direction: column;
    right: 0;
    height: auto;
    margin-bottom: 10px;
    .owl{
      display: none;
    }
    gap: 0;
    align-items: center;
    &-left{
      margin-left:0;
      height: 450px;
      
      img{
        object-fit: cover;
      }
    }
    &-right{
      align-items: center;
      height: auto;
      display: flex;
      gap: 10px;
      h1{
        margin-top: 10px;
      }
    }
  }
  .review-section{
    padding-left:20px ;
    padding-right:20px ;

    .make-review-section{
      form{
        height: auto;
        div{
          width: 100%;
        }
      }
    }
    .reviews{
      ul{
        align-items: center;
        li{
          flex-direction: column;
          height: auto;
          div{
            flex-direction: column;
            align-items: center;
            img{
              width: auto;
            }
          }
          p{
            text-align: center;
          }
        }
      }
    }
  }
}

}

@media (min-width: 1025px) and (max-width: 1440px) {
  main{
    height: auto;
    .book-section{
      right: 0;
      height: 550px;
      .owl{
        display: none;
      }
      &-left{
        img{
          object-fit: cover;
        }
      }
      &-right{
        ul{
          display: flex;
          flex-wrap: wrap;
        }
        p{
          font-size: 1.1rem;
          line-height: 20px;
        }
      }
    }
    .review-section{
      .make-review-section{
        height: 100%;
        form{
          width: 100%;
          height: 370px;
          div{
            width: 100%;
          }
        }
      }
      .reviews{
        ul{
          li{
            height: 200px;
            width: 100%;
          }
        }
      }
    }
  }
}
</style>
